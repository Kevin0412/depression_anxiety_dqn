# 元认知低自信的计算机制：基于DQN的模拟与验证

持续性低自信是焦虑和抑郁个体的核心认知特征，但其背后的计算机制尚不明确。Katyal等人（2025）的最新研究表明，这种低自信可能源于对高局部自信时刻的学习不足，而非对负面信息的过度敏感。为验证这一心理机制的计算合理性，本研究结合认知心理学理论与深度强化学习方法，提出了一个计算建模框架。

通过构建一个引入"自信折扣"机制的抑郁DQN模型，我们在CartPole环境中模拟了焦虑-抑郁个体的认知扭曲。模型在训练过程中对Q值最高的前30%经验施加1%的学习折扣，以模拟对高自信时刻的整合不足。通过对198次独立运行的对比分析发现：与正常DQN模型相比，抑郁模型表现出显著的低最终性能（106.7±53.5 vs 410.5±162.3）和低成功率（5.2% vs 39.6%），同时呈现独特的"前期优势-后期衰退"学习动态（图1a）。此结果证明，单一的对高自信信号的学习扭曲足以产生持续性低自信与适应不良，为心理学理论提供了计算层面的证据。

本研究成功架设了认知心理学与人工智能的桥梁，不仅验证了"自信学习扭曲"机制的计算可行性，还展示了利用计算模型探索精神病理现象的新范式，为理解与干预元认知偏差提供了新的视角和方法。


## 项目说明

简要说明本项目包含的主要脚本与用途（更简单的版本）：
- `exp.py`：训练脚本（单次实验/训练），当前不提供命令行参数接口。
- `run.sh`：用于重复运行 `exp.py`（简单循环）。
- `analyze_data.py`：对实验数据进行分析并生成表格与总结（无复杂可选参数）。
- `experiment_results/`：存放训练输出（主要为表格和总结文件）。

环境与依赖（Linux，使用 conda）
- 项目包含 `requirements.txt`：推荐使用 conda 环境并通过该文件安装依赖。
- 可能仅在支持 NVIDIA CUDA 的 GPU 上直接工作；在 CPU 上运行可能需要修改代码（未专门适配 CPU）。
- 可能其他操作系统也行，没配置过

快速示例命令（conda）
1. 创建并激活 conda 环境，安装依赖：
```
conda create -n myenv python=3.11 -y
conda activate myenv
pip install -r requirements.txt
```
（若需特定 CUDA 版本或用 conda 安装深度学习框架，请根据项目要求使用 conda-forge 或官方安装命令，例如使用 `conda install pytorch cudatoolkit=11.7 -c pytorch` 等。）

2. 单次训练（当前目录下）：
```
python exp.py
```
3. 指定 GPU（常用方法）：
```
CUDA_VISIBLE_DEVICES=0 python exp.py
```
4. 批量/重复运行（确保有执行权限）：
```
chmod +x run.sh
bash run.sh
```
5. 分析与生成表格/总结（读取 `experiment_results`）：
```
python analyze_data.py
```

输出说明
- 训练不会产生日志文件（默认无日志模块写入）；输出主要为表格和总结，保存在 `experiment_results/` 的相应子目录中。
- `analyze_data.py` 读取 `experiment_results/` 下的数据并生成用于查看的表格或汇总文件（输出路径可在脚本中查看或修改）。

注意事项
- 当前脚本未实现丰富的命令行参数或日志功能；如需添加参数、日志或 CPU 支持，请在对应脚本中修改实现。
- 若需示例配置或更详细的参数说明，请提供脚本头部的 usage 信息或希望的参数列表，以便扩展 README。
- 使用 conda 时，如遇 CUDA/库版本冲突，请按框架文档安装匹配的 cudatoolkit 或通过官方 conda 通道安装相应包。
